<div class="quiz-header">
  <h1>{{ quizName }}</h1>
  <span class="question-count">Question {{ currentQuestionIndex + 1 }} of {{ questions.length }}</span>
</div>

<div class="quiz-container">
  <!-- Loading spinner overlay for non-creator users -->
  <div class="loading-overlay" *ngIf="!isCreator && isFinished">
    <div class="loading-content">
      <mat-spinner diameter="60" color="primary"></mat-spinner>
      <p class="loading-text">
        {{ canEndQuiz ? 'Waiting for creator to end quiz' : 'Creator is submitting all answers...' }}
      </p>
    </div>
  </div>

  <div class="quiz-card" *ngIf="currentQuestion">
    <div class="question-timer">
      <!-- Use inline style for direct animation control -->
      <div id="timer-bar" class="timer-bar" [style.width.%]="timerWidth"></div>
    </div>

    <div class="question-content">
      <h2>{{ currentQuestion.question }}</h2>
      
      <div class="answer-options">
        <div *ngFor="let answer of currentQuestion.answers; let i = index" 
             class="answer-option"
             [class.selected]="selectedAnswer === i"
             (click)="!isCreator && (selectedAnswer = i)">
          <mat-radio-button 
            [value]="i"
            [checked]="selectedAnswer === i"
            [disabled]="isCreator">
            {{ answer }}
          </mat-radio-button>
        </div>
      </div>
    </div>

    <div class="quiz-actions">
      <button 
        mat-raised-button 
        color="primary"
        (click)="submitAnswer()"
        [disabled]="selectedAnswer === null || isCreator || isFinished">
        Submit Answer
      </button>

      <button 
        *ngIf="isCreator && isFinished"
        mat-raised-button 
        color="primary"
        (click)="submitAllUsersAnswers()"
        [disabled]="!isCreator || canEndQuiz">
        Submit All Answers
      </button>

      <button 
        *ngIf="isCreator && isFinished && canEndQuiz"
        mat-raised-button 
        color="accent"
        (click)="endQuiz()">
        End Quiz
      </button>
    </div>
  </div>
</div>
